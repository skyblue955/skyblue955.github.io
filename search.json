[{"title":"Hello World","url":"/2022/11/21/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n"},{"title":"web刷题(一)","url":"/2022/11/22/web%E5%88%B7%E9%A2%98-%E4%B8%80/","content":"ssrf（服务端请求伪造）​\t原因：web网站会从其他的服务器获取信息然后显示到当前网站上，而这个获取信息的url链接是用户自己可控的，且过滤要求不是很严\n​\t危害：可用来获取web服务器本地的一些敏感文件，如使用php伪协议的file:&#x2F;&#x2F;\nIP 伪造​\tX-Foewared-For：用来获取客户端的ip地址—-可自定义伪造\n模块注入​\tjava的spring， python的flask，php的tp \n​\t用户提交的信息被当作代码执行：\n​\t\t其中变量为 {  {  } } 的形式 \nshell命令​\t单引号中的变量( $shell ) 不会 被当作变量执行\n​\t双引号中的变量( $shell ) 会被当做变量执行\n┌──(kali㉿kali)-[~]└─$ echo &quot;\\&lt;&quot;                                                            \\&lt;                                                                                                                                                                                                 ┌──(kali㉿kali)-[~]└─$ echo &#x27;\\&lt;&#x27;\\&lt;                                                                                                                                                                                                 ┌──(kali㉿kali)-[~]└─$ echo \\&lt;  &lt;\t\t\t\t#没有引号的时候，会转义，\n\n\npython的虚拟环境:\n# 创建python -m venv 环境名# 激活source 环境名/bin/sctivate#退出deactivate\n\n\n\n正则表达式​\t循环匹配的—- ( ?R )\n\n​\t ( ?R )\t ：匹配一次   \n ( ?R )+   ：匹配一次或多次  \n\n​\t ( ?R )*    ：匹配0次或多次 \n​\t ( ?R )？   ：匹配0次或1词   \n​\t  \n​\t因为是递归循环匹配的（相当于一直在循环匹配），前两个如果匹配到的话是没有退出条件的（所以匹配不成功），而后两个是由退出条件（即为0次，时），所以可以匹配成功\n​\t例子：\n​\t\ta(b(c()))—–若按第二个匹配来的话，那么最里的括号里应该还有能匹配的\n​\t\t\t\t\t\t\t按第三个来的话，匹配到 ***c()***时，此时没有能匹配的了，匹配次数为0.相当于在此停止匹配了\nphp\n读文件到页面的方法：\n\n​\tphp伪协议：file：//或php：//filte\n\nfile_get_contents()函数\n\n​    使用系统命令，如：system(&quot;ls&quot;)或system(&quot; cat /flag&quot;)\n\n​    使用highlight_file()或show_source()\n\nphp使用session（可用来伪造session信息，从而绕过安全检测！！）\n\n手动启用：session_start() #会自动生成一个session_id值\n自定义session的值：$_session[&#39;key&#39;]\n可使用抓包工具更改session_id的值，然后服务端使用函数读取session_id，以此来绕过一些字符串检测\n\n\n\n\nphp伪协议：\n\n​\t读文件\n\nphp://filter/read=convert.base64-encode/resource= &#39; xxx.php &#39;\n\nfile://&#39; 路径名 &#39;\n\n​    写文件(输入文件流)\n\nphp://filter/write=convert.base64-encode/resource=&#39;  xxx.php &#39; &amp;&amp; txt= &quot;内容&quot;\nphp://filter/resource=&#39;  xxx.php &#39; &amp;&amp; txt= &quot;内容&quot;\nphp://input  ----- 此时使用post传数据流\ndata://text/plain;base64,&quot; 编码内容 “\n\n\n\n\n​    执行命令\n\n\n\nphp的坑：\n\n​\t在后端传参时，有些特殊字符会被默认替换：\n\n\n\n​\t\t     如： .*  =&gt; _*    即传参数时，小数点开头则会被替换为_\n​\t\t 2.    使用变量输出时，单引号中变量不存在，双引号中变量存在\npreg_replace($pattern, $replacement, $subject)函数，其中$pattern的标志有\\e，PHP 5.5.0 起， 传入 “\\e” 修饰符的时候，会产生一个 E_DEPRECATED 错误； PHP 7.0.0 起，会产生 E_WARNING 错误，同时 “\\e” 也无法起效。\npreg_replace（）函数的漏洞\n​\t匹配成功后，第二个参数会被当作代码执行\n​\t而preg_replace(&#39;/(&#39; . $re . &#39;)/ei&#39;,&#39;strtolower(&quot;\\\\1&quot;)&#39;,$str）中的\\\\1会被解释为\\1 即为正则匹配到的第一个字符（group(1)）\n​\t漏洞执行过程：\npreg_replace(&#x27;/.*/ei&#x27;,&#x27;strtolower(&quot;\\\\1&quot;)&#x27;,phpinfo()）             相当于是 eval(&#x27;strtolower(&quot;phpinfo()&quot;)&#x27;),此时phpinfo()是一个字符串，不能执行该代码preg_replace(&#x27;/.*/ei&#x27;,&#x27;strtolower(&quot;\\\\1&quot;)&#x27;,$&#123;phpinfo()&#125;)             相当于是 eval(&#x27;strtolower(&quot;$&#123;phpinfo()&#125;&quot;)&#x27;) 此时phpinfo()是一个变量，可以执行改代码，             但是！！！当strtolower()内为单引号时，便不行了！！！！！\n\n\n\nphp的循环遍历：\nforeach($_GET as $key =&gt; $value)&#123;    print($key);    print($value);&#125;\n\n\n\nnmapnamp 的 oG 命令，可以写入文件\nnmap  -sT 192.168.1.0 -oG  123.php\t#把执行过程与结果，写入到文件123.php中nmao &#x27;&#x27;/&lt;/?&#x27;&#x27;\n\n\n\n\n\n","categories":["Web"],"tags":["ssrf","nmap","正则","preg_replace"]}]